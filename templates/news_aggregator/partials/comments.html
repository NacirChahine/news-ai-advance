{% load static %}
<div id="comments-section" class="mt-4" data-article-id="{{ article.id }}"
     data-list-url="{% url 'news_aggregator:comments_list_create' article.id %}"
     data-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h5 class="mb-0">
      <i class="far fa-comments me-2"></i>Comments
      <span class="comment-count-badge">(<span id="comment-count-header">{{ comment_count|default:0 }}</span>)</span>
    </h5>
    <small class="text-muted">Be respectful. No personal attacks.</small>
  </div>

  {% if user.is_authenticated %}
  <div class="card mb-3">
    <div class="card-body">
      <form id="comment-create-form">
        <div class="mb-2">
          <textarea class="form-control" id="comment-content" rows="3" maxlength="5000" placeholder="Write a comment..."></textarea>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Post Comment</button>
      </form>
    </div>
  </div>
  {% else %}
  <div class="alert alert-secondary">
    <i class="fas fa-user-lock me-2"></i>
    <a href="{% url 'accounts:login' %}?next={{ request.get_full_path|urlencode }}">Log in</a> to comment.
  </div>
  {% endif %}

  <div id="comments-list" class="list-group mb-2"></div>
  <nav>
    <ul class="pagination pagination-sm" id="comments-pagination"></ul>
  </nav>
</div>
<script defer src="{% static 'js/comments.js' %}"></script>
